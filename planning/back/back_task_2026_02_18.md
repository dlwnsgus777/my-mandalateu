# 백엔드 작업 체크리스트

> 작성일: 2026-02-18
> 기준: `back_task_2026_02_16.md` 설계 기반
> 현재 상태: Phase 1 ~ Phase 7 완료

---

## 진행 현황 요약

| Phase | 내용 | 상태 |
|-------|------|------|
| Phase 1 | 프로젝트 초기 설정 | ✅ 완료 |
| Phase 2 | 도메인 엔티티 & Repository | ✅ 완료 |
| Phase 3 | 인증 (JWT + Security) | ✅ 완료 |
| Phase 4 | 만다라트 API | ✅ 완료 |
| Phase 5 | Strategy / ActionItem API | ✅ 완료 |
| Phase 6 | 대시보드 API | ✅ 완료 |
| Phase 7 | 예외 처리 & 검증 | ✅ 완료 |

---

## Phase 1 — 프로젝트 초기 설정 ✅

- [x] Spring Boot 프로젝트 생성 (Gradle Kotlin DSL, Kotlin 2.x, JVM 21)
- [x] `build.gradle.kts` 의존성 추가 (web, jpa, security, validation, mysql, jjwt, kotlin-reflect)
- [x] `application.yml` 기본 설정 (DB 연결, JPA, JWT secret, Security)
- [ ] MySQL 데이터베이스 생성 (`CREATE DATABASE mandalateu`)

---

## Phase 2 — 도메인 엔티티 & Repository ✅

### Entity

- [x] `user/domain/User.kt`
  - id (BIGINT PK), email (UNIQUE), password (BCrypt), nickname, createdAt
- [x] `mandalart/domain/Mandalart.kt`
  - id, userId (FK → User), title, createdAt, updatedAt
- [x] `strategy/domain/Strategy.kt`
  - id, mandalartId (FK), position (0~8), title, color (nullable), notes (nullable)
- [x] `actionitem/domain/ActionItem.kt`
  - id, strategyId (FK), position (0~8), isCenter, title, description (nullable)
  - completed, completedAt (nullable), deadline (nullable), priority (ENUM: HIGH/MEDIUM/LOW, nullable)
- [x] `actionitem/domain/Priority.kt` — enum class

### Repository

- [x] `user/repository/UserRepository.kt` — `findByEmail` 메서드 포함
- [x] `mandalart/repository/MandalartRepository.kt` — `findAllByUserId` 메서드 포함
- [x] `strategy/repository/StrategyRepository.kt` — `findAllByMandalartId` 메서드 포함
- [x] `actionitem/repository/ActionItemRepository.kt`
  - `findAllByStrategyId`
  - `findAllByStrategyIdInAndCompletedTrue` (대시보드용)
  - `findAllByStrategyIdInAndDeadlineIsNotNull` (마감일 조회용)

---

## Phase 3 — 인증 (JWT + Spring Security) ✅

### JWT

- [x] `auth/jwt/JwtProvider.kt`
  - `generateAccessToken(userId)`, `generateRefreshToken(userId)`
  - `validateToken(token)`, `getUserIdFromToken(token)`
  - `type` 클레임으로 access/refresh 구분 추가
- [x] `auth/jwt/JwtFilter.kt`
  - `OncePerRequestFilter` 상속
  - Authorization 헤더에서 Bearer 토큰 추출 → SecurityContext에 등록

### Security Config

- [x] `common/config/SecurityConfig.kt`
  - `permitAll`: `POST /api/v1/auth/**`
  - `authenticated`: 나머지 모든 경로
  - `JwtFilter`를 `UsernamePasswordAuthenticationFilter` 앞에 등록
  - CSRF 비활성화, Session stateless 설정
- [x] `common/security/UserDetailsServiceImpl.kt`
  - `UserRepository.findByEmail` 기반 구현

### Auth 기능

- [x] `auth/dto/SignupRequest.kt` — email, password, nickname (`@Valid` 포함)
- [x] `auth/dto/LoginRequest.kt` — email, password
- [x] `auth/dto/RefreshRequest.kt` — refreshToken (추가됨)
- [x] `auth/dto/TokenResponse.kt` — accessToken, refreshToken, tokenType
- [x] `auth/dto/SignupResponse.kt` — id, email, nickname
- [x] `auth/service/AuthService.kt`
  - `signup`: 이메일 중복 확인, BCrypt 해시 후 저장
  - `login`: 비밀번호 검증, Access/Refresh 토큰 발급
  - `refresh`: Refresh 토큰 검증 후 Access/Refresh 토큰 재발급 (토큰 로테이션)
- [x] `auth/controller/AuthController.kt`
  - `POST /api/v1/auth/signup`
  - `POST /api/v1/auth/login`
  - `POST /api/v1/auth/refresh`

---

## Phase 4 — 만다라트 API ✅

### DTO

- [x] `mandalart/dto/MandalartCreateRequest.kt` — title, coreGoal (`@NotBlank`)
- [x] `mandalart/dto/MandalartUpdateRequest.kt` — title (nullable)
- [x] `mandalart/dto/MandalartResponse.kt` — id, title, createdAt, updatedAt, strategies (중첩, 내부에 StrategyDto/ActionItemDto 포함)
- [x] `mandalart/dto/MandalartSummaryResponse.kt` — 목록 조회용 (strategies 미포함)

### Service & Controller

- [x] `mandalart/service/MandalartService.kt`
  - `getList(userId)`: 내 만다라트 목록
  - `create(userId, request)`: Mandalart + 9개 Strategy + 81개 ActionItem 자동 초기화
  - `getDetail(userId, mandalartId)`: 상세 조회 (소유자 검증)
  - `update(userId, mandalartId, request)`: 제목 수정 (소유자 검증)
  - `delete(userId, mandalartId)`: 삭제 (소유자 검증, 연관 데이터 cascade)
- [x] `mandalart/controller/MandalartController.kt`
  - `GET /api/v1/mandalarts`
  - `POST /api/v1/mandalarts`
  - `GET /api/v1/mandalarts/{mandalartId}`
  - `PATCH /api/v1/mandalarts/{mandalartId}`
  - `DELETE /api/v1/mandalarts/{mandalartId}`

### 추가 생성 파일

- [x] `common/exception/EntityNotFoundException.kt` — 404용 (Phase 7 GlobalExceptionHandler와 연동 예정)
- [x] `common/exception/ForbiddenException.kt` — 403용 (Phase 7 GlobalExceptionHandler와 연동 예정)
- [x] `actionitem/repository/ActionItemRepository.kt` — `findAllByStrategyIdIn`, `deleteAllByStrategyIdIn` 추가

---

## Phase 5 — Strategy / ActionItem API ✅

### Strategy

- [x] `strategy/dto/StrategyUpdateRequest.kt` — title, color, notes (모두 nullable)
- [x] `strategy/dto/StrategyResponse.kt`
- [x] `strategy/service/StrategyService.kt`
  - `update(userId, mandalartId, strategyId, request)`: 소유자 검증 포함
- [x] `strategy/controller/StrategyController.kt`
  - `PATCH /api/v1/mandalarts/{mandalartId}/strategies/{strategyId}`

### ActionItem

- [x] `actionitem/dto/ActionItemUpdateRequest.kt` — title, completed, deadline, priority, description (모두 nullable)
- [x] `actionitem/dto/ActionItemResponse.kt`
- [x] `actionitem/service/ActionItemService.kt`
  - `update(userId, mandalartId, strategyId, actionItemId, request)`
  - `completed = true`로 변경 시 `completedAt` 자동 설정, `false`로 변경 시 null 처리
- [x] `actionitem/controller/ActionItemController.kt`
  - `PATCH /api/v1/mandalarts/{mandalartId}/strategies/{strategyId}/action-items/{actionItemId}`

### 기타

- [x] `junit-platform.properties` — 테스트 클래스 단위 병렬 실행 설정 추가

---

## Phase 6 — 대시보드 API ✅

### DTO

- [x] `dashboard/dto/SummaryResponse.kt` — totalCount, completedCount, completionRate, strategyStats 목록
- [x] `dashboard/dto/WeeklyStatsResponse.kt` — weekRange, dailyStats, thisWeekTotal, lastWeekTotal, changeRate
- [x] `dashboard/dto/StreakResponse.kt` — currentStreak, bestStreak, lastCompletedDate
- [x] `dashboard/dto/DeadlineResponse.kt` — actionItemId, title, strategyTitle, deadline, status (TODAY/TOMORROW/SOON)

### Service & Controller

- [x] `dashboard/service/DashboardService.kt`
  - `getSummary(userId, mandalartId)`: 전체/Strategy별 진행률
  - `getWeeklyStats(userId, mandalartId)`: 이번 주 요일별 완료 수, 지난 주 대비 증감률
  - `getStreak(userId, mandalartId)`: `completedAt` 기준 연속 달성일 계산
  - `getDeadlines(userId, mandalartId)`: 마감일 오름차순, TODAY/TOMORROW/SOON 분류
- [x] `dashboard/controller/DashboardController.kt`
  - `GET /api/v1/mandalarts/{mandalartId}/dashboard/summary`
  - `GET /api/v1/mandalarts/{mandalartId}/dashboard/weekly`
  - `GET /api/v1/mandalarts/{mandalartId}/dashboard/streak`
  - `GET /api/v1/mandalarts/{mandalartId}/dashboard/deadlines`

---

## Phase 7 — 예외 처리 & 검증 ✅

- [x] `common/exception/DuplicateEmailException.kt` — 신규 추가 (AuthService에서 사용)
- [x] `common/exception/ErrorResponse.kt` — code, message, timestamp, fieldErrors (nullable)
- [x] `common/exception/GlobalExceptionHandler.kt` (`@RestControllerAdvice`)
  - `EntityNotFoundException` → 404 (`NOT_FOUND`)
  - `ForbiddenException` → 403 (`FORBIDDEN`)
  - `DuplicateEmailException` → 409 (`DUPLICATE_EMAIL`)
  - `HttpMessageNotReadableException` → 400 (`BAD_REQUEST`)
  - `MethodArgumentNotValidException` → 400 (`VALIDATION_FAILED`, fieldErrors 포함)
  - 기타 `Exception` → 500 (`INTERNAL_SERVER_ERROR`)
- [x] 각 Request DTO `@Valid` 점검 — 모두 적용 완료

---

## 생성 파일 목록 (총 28개)

```
src/main/kotlin/com/mandalateu/
├── auth/
│   ├── controller/   AuthController.kt
│   ├── dto/          SignupRequest.kt, LoginRequest.kt, TokenResponse.kt, SignupResponse.kt
│   ├── service/      AuthService.kt
│   └── jwt/          JwtProvider.kt, JwtFilter.kt
├── user/
│   ├── domain/       User.kt
│   └── repository/   UserRepository.kt
├── mandalart/
│   ├── controller/   MandalartController.kt
│   ├── dto/          MandalartCreateRequest.kt, MandalartUpdateRequest.kt, MandalartResponse.kt, MandalartSummaryResponse.kt
│   ├── service/      MandalartService.kt
│   ├── domain/       Mandalart.kt
│   └── repository/   MandalartRepository.kt
├── strategy/
│   ├── controller/   StrategyController.kt
│   ├── dto/          StrategyUpdateRequest.kt, StrategyResponse.kt
│   ├── service/      StrategyService.kt
│   ├── domain/       Strategy.kt
│   └── repository/   StrategyRepository.kt
├── actionitem/
│   ├── controller/   ActionItemController.kt
│   ├── dto/          ActionItemUpdateRequest.kt, ActionItemResponse.kt
│   ├── service/      ActionItemService.kt
│   ├── domain/       ActionItem.kt, Priority.kt
│   └── repository/   ActionItemRepository.kt
├── dashboard/
│   ├── controller/   DashboardController.kt
│   ├── dto/          SummaryResponse.kt, WeeklyStatsResponse.kt, StreakResponse.kt, DeadlineResponse.kt
│   └── service/      DashboardService.kt
└── common/
    ├── config/       SecurityConfig.kt
    ├── exception/    GlobalExceptionHandler.kt, ErrorResponse.kt
    └── security/     UserDetailsServiceImpl.kt
```

---

## 작업 우선순위

1. **MySQL DB 생성** — 서버 기동 전 필수
2. **Phase 2** (Entity/Repository) — 모든 Phase의 기반
3. **Phase 3** (JWT/Security) — API 인증 기반
4. **Phase 4 → 5 → 6** — 기능 순서대로
5. **Phase 7** (예외처리) — 각 Phase와 병행 가능, 최종 점검 시 마무리